extern crate quickxml_to_serde;
#[cfg(feature = "json_types")]
use quickxml_to_serde::{xml_string_to_json, Config, JsonArray, JsonType};

#[cfg(feature = "json_types")]
fn main() {
    let xml = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<package>\n<volume vid=\"126118\"><![CDATA[第一卷 极彩魔女]]>\n<chapter cid=\"126119\"><![CDATA[序章 初恋]]></chapter>\n<chapter cid=\"126120\"><![CDATA[第一章 融合]]></chapter>\n<chapter cid=\"126121\"><![CDATA[第二章 庭园]]></chapter>\n<chapter cid=\"126122\"><![CDATA[第三章 变换]]></chapter>\n<chapter cid=\"126123\"><![CDATA[第四章 约会]]></chapter>\n<chapter cid=\"126124\"><![CDATA[第五章 魔女]]></chapter>\n<chapter cid=\"126125\"><![CDATA[终章 未来（求婚）]]></chapter>\n<chapter cid=\"126126\"><![CDATA[后记]]></chapter>\n<chapter cid=\"126127\"><![CDATA[插图]]></chapter>\n<chapter cid=\"136552\"><![CDATA[蜜瓜特典]]></chapter>\n<chapter cid=\"136553\"><![CDATA[虎穴特典]]></chapter>\n<chapter cid=\"136554\"><![CDATA[A店特典]]></chapter>\n<chapter cid=\"136555\"><![CDATA[G店特典]]></chapter>\n</volume>\n<volume vid=\"131393\"><![CDATA[第二卷 鸨羽恶魔]]>\n<chapter cid=\"131394\"><![CDATA[序章 直播主克拉拉]]></chapter>\n<chapter cid=\"131395\"><![CDATA[第一章【震惊】我成了空降女主角]]></chapter>\n<chapter cid=\"131742\"><![CDATA[第二章【快报】人家交到男朋友了！]]></chapter>\n<chapter cid=\"132278\"><![CDATA[第三章【对决】魔女大人VS克拉拉，爱的三回合]]></chapter>\n<chapter cid=\"132677\"><![CDATA[第四章【必看】交流战拉开序幕]]></chapter>\n<chapter cid=\"132785\"><![CDATA[第五章【慎入】告诉你克拉拉的秘密吧]]></chapter>\n<chapter cid=\"132786\"><![CDATA[终章 叛徒喰良]]></chapter>\n<chapter cid=\"132787\"><![CDATA[后记]]></chapter>\n<chapter cid=\"132788\"><![CDATA[插图]]></chapter>\n<chapter cid=\"136582\"><![CDATA[蜜瓜特典]]></chapter>\n<chapter cid=\"136583\"><![CDATA[虎穴特典]]></chapter>\n<chapter cid=\"136584\"><![CDATA[A店特典]]></chapter>\n<chapter cid=\"136585\"><![CDATA[G店特典]]></chapter>\n</volume>\n<volume vid=\"136339\"><![CDATA[第三卷 瑠璃骑士]]>\n<chapter cid=\"136340\"><![CDATA[序章 往日心意决 迄今志不移]]></chapter>\n<chapter cid=\"136341\"><![CDATA[第一章 本家捎来信 骑士急出行]]></chapter>\n<chapter cid=\"136342\"><![CDATA[第二章 魔女征千里 深海龙宫城]]></chapter>\n<chapter cid=\"136343\"><![CDATA[第三章 公主陷囹圄 谁人启心门]]></chapter>\n<chapter cid=\"136344\"><![CDATA[第四章 花烛喜筵开 蓝焰结契时]]></chapter>\n<chapter cid=\"136345\"><![CDATA[第五章 古之仇敌殁 于今又复生]]></chapter>\n<chapter cid=\"136346\"><![CDATA[终章 积年情意重 今朝告君知]]></chapter>\n<chapter cid=\"136347\"><![CDATA[后记]]></chapter>\n<chapter cid=\"136348\"><![CDATA[插图]]></chapter>\n<chapter cid=\"136927\"><![CDATA[蜜瓜特典]]></chapter>\n<chapter cid=\"136928\"><![CDATA[A店特典]]></chapter>\n<chapter cid=\"136929\"><![CDATA[G店特典]]></chapter>\n</volume>\n<volume vid=\"132114\"><![CDATA[短篇]]>\n<chapter cid=\"132115\"><![CDATA[约会大作战X国王的求婚联动短篇 彩祸crossover]]></chapter>\n<chapter cid=\"132676\"><![CDATA[DragonMagazine2021年11月号 Garden Guidance庭园引导]]></chapter>\n<chapter cid=\"132292\"><![CDATA[Dragon Magazine2022年1月号 Dormitory Panic]]></chapter>\n<chapter cid=\"133048\"><![CDATA[DragonMagazine2022年3月号 Sister’s Cafe]]></chapter>\n<chapter cid=\"136481\"><![CDATA[DragonMagazine2022年11月号 Teacher’s day教师的一天]]></chapter>\n<chapter cid=\"138368\"><![CDATA[Dragon Magazine2023年1月号 Sister collection 姐姐宝可梦]]></chapter>\n<chapter cid=\"140122\"><![CDATA[富士见文库34周年小册子 Witch's cupcake魔女的纸杯蛋糕]]></chapter>\n<chapter cid=\"140123\"><![CDATA[DM杂志2023年3月号 Undead streamer不死主播]]></chapter>\n<chapter cid=\"141389\"><![CDATA[Gamers活动特典 Brilliant Lesson极彩之课程]]></chapter>\n<chapter cid=\"141669\"><![CDATA[日历短篇 Magic·Ceremony魔法典礼]]></chapter>\n<chapter cid=\"148223\"><![CDATA[富士见35周年特典 Halloween·Imagination 万圣·想象力]]></chapter>\n<chapter cid=\"149227\"><![CDATA[DM杂志2024年1月号 Charming match魅力比赛]]></chapter>\n<chapter cid=\"150717\"><![CDATA[DM杂志2024年3月号 Doggy adventure狗狗冒险]]></chapter>\n<chapter cid=\"158918\"><![CDATA[总有一天苍穹之DATE·A·PROPOSE]]></chapter>\n</volume>\n<volume vid=\"142040\"><![CDATA[第四卷 黄金神子]]>\n<chapter cid=\"142041\"><![CDATA[序章 你以为这是梦吗？]]></chapter>\n<chapter cid=\"142042\"><![CDATA[第一章 你在等苏吗？]]></chapter>\n<chapter cid=\"142394\"><![CDATA[第二章 你很想见魔女大人吧？]]></chapter>\n<chapter cid=\"142542\"><![CDATA[第三章 你想看女仆吗？]]></chapter>\n<chapter cid=\"142735\"><![CDATA[第四章 你想要我阻止你对吧……？]]></chapter>\n<chapter cid=\"142914\"><![CDATA[第五章 世界要被夺走了吗？]]></chapter>\n<chapter cid=\"142915\"><![CDATA[终章 未来很令人期待吧？]]></chapter>\n<chapter cid=\"142916\"><![CDATA[后记]]></chapter>\n<chapter cid=\"142917\"><![CDATA[插图]]></chapter>\n<chapter cid=\"143691\"><![CDATA[G店特典]]></chapter>\n<chapter cid=\"143692\"><![CDATA[蜜瓜特典]]></chapter>\n<chapter cid=\"143693\"><![CDATA[A店特典]]></chapter>\n</volume>\n<volume vid=\"146482\"><![CDATA[第五卷 真赭贤者]]>\n<chapter cid=\"146483\"><![CDATA[序章 魔女一来，邪自消散]]></chapter>\n<chapter cid=\"146484\"><![CDATA[第一章 造访孤岛的补修生]]></chapter>\n<chapter cid=\"146886\"><![CDATA[第二章 暗藏的祸心与水灵]]></chapter>\n<chapter cid=\"146931\"><![CDATA[第三章 出落标致的女孩]]></chapter>\n<chapter cid=\"147372\"><![CDATA[第四章 短暂的蜜月与别离]]></chapter>\n<chapter cid=\"147931\"><![CDATA[第五章 赭色大神的现身]]></chapter>\n<chapter cid=\"147932\"><![CDATA[终章 跨越往昔，迎向未来]]></chapter>\n<chapter cid=\"147933\"><![CDATA[后记]]></chapter>\n<chapter cid=\"147934\"><![CDATA[插图]]></chapter>\n<chapter cid=\"147942\"><![CDATA[G店特典]]></chapter>\n<chapter cid=\"147943\"><![CDATA[A店特典]]></chapter>\n<chapter cid=\"147944\"><![CDATA[蜜瓜特典]]></chapter>\n</volume>\n<volume vid=\"148224\"><![CDATA[漫画特典短篇]]>\n<chapter cid=\"148225\"><![CDATA[一卷特典 魔女的午餐时间Witch’s lunchtime]]></chapter>\n<chapter cid=\"148226\"><![CDATA[二卷特典 狂信者骑士Fanatic knight]]></chapter>\n</volume>\n<volume vid=\"152727\"><![CDATA[第六卷 银灰的妖精]]>\n<chapter cid=\"152728\"><![CDATA[序章 乐园风景(game start)]]></chapter>\n<chapter cid=\"152729\"><![CDATA[第一章 悄然接近的《恐怖》]]></chapter>\n<chapter cid=\"152974\"><![CDATA[第二章 前往《RPG》世界]]></chapter>\n<chapter cid=\"153257\"><![CDATA[第三章 决胜手是《恋爱模拟》]]></chapter>\n<chapter cid=\"153744\"><![CDATA[第四章 从谜之房间《逃脱》]]></chapter>\n<chapter cid=\"154375\"><![CDATA[第五章 最后的《谜题》]]></chapter>\n<chapter cid=\"154376\"><![CDATA[终章 巡魂祭(ending)]]></chapter>\n<chapter cid=\"154377\"><![CDATA[后记]]></chapter>\n<chapter cid=\"154378\"><![CDATA[插图]]></chapter>\n<chapter cid=\"154728\"><![CDATA[蜜瓜特典]]></chapter>\n<chapter cid=\"154729\"><![CDATA[G店特典]]></chapter>\n<chapter cid=\"154730\"><![CDATA[A店特典]]></chapter>\n</volume>\n<volume vid=\"159945\"><![CDATA[第七卷 乌黑的从者]]>\n<chapter cid=\"159946\"><![CDATA[序章 庭园夜会心得]]></chapter>\n<chapter cid=\"159947\"><![CDATA[第一章 请谨慎通知监护人]]></chapter>\n<chapter cid=\"159948\"><![CDATA[第二章 请勿说谎、冒充]]></chapter>\n<chapter cid=\"160400\"><![CDATA[第三章 请欣赏丰富多彩的节目]]></chapter>\n<chapter cid=\"160401\"><![CDATA[第四章 请冷静地处理麻烦]]></chapter>\n<chapter cid=\"160849\"><![CDATA[第五章 进行爱的告白什么的……请自便]]></chapter>\n<chapter cid=\"160850\"><![CDATA[终章 最后，请盛大地办庆功宴]]></chapter>\n<chapter cid=\"160851\"><![CDATA[后记]]></chapter>\n<chapter cid=\"160852\"><![CDATA[插图]]></chapter>\n</volume>\n</package>";

    // custom config values for 1 attribute and a text node
    let conf = Config::new_with_defaults()
        .add_json_type_override("/a/b/@attr1", JsonArray::Infer(JsonType::AlwaysString))
        .add_json_type_override("/a/b", JsonArray::Infer(JsonType::AlwaysString));
    let json = xml_string_to_json(String::from(xml), &conf);
    println!("{}", json.expect("Malformed XML").to_string());
}

#[cfg(not(feature = "json_types"))]
fn main() {
    println!("Run this example with `--features json_types` parameter");
}
